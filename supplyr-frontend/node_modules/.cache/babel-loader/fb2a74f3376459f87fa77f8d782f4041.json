{"ast":null,"code":"import _slicedToArray from\"/Users/keeganfinegan/Documents/2021/SoftwareDevelopment/Assignment/supplyr/supplyr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/keeganfinegan/Documents/2021/SoftwareDevelopment/Assignment/supplyr/supplyr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/keeganfinegan/Documents/2021/SoftwareDevelopment/Assignment/supplyr/supplyr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState}from'react';import'./Orders.css';import{Container,Row,Col,Table,Button}from'react-bootstrap';import Cookies from'js-cookie';import jwt_decode from'jwt-decode';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var deleteOffer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(orderId){var url,token,response,decode,newDataResponse,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url=\"http://localhost:8080/api/v1/offers/delete/\";token=Cookies.get('token');_context.prev=2;_context.next=5;return fetch(url+orderId,{method:'POST',headers:{Authorization:'Bearer '+token,accept:'application/json','Content-Type':'application/json'}});case 5:response=_context.sent;if(!response.ok){_context.next=15;break;}decode=jwt_decode(token);_context.next=10;return fetch('http://localhost:8080/api/v1/users/'+decode.sub());case 10:newDataResponse=_context.sent;data=newDataResponse.json();return _context.abrupt(\"return\",data.organisationalUnit.offers);case 15:console.log(response.json());//\ncase 16:_context.next=20;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](2);case 20:case\"end\":return _context.stop();}}},_callee,null,[[2,18]]);}));return function deleteOffer(_x){return _ref.apply(this,arguments);};}();export var Orders=function Orders(props){var _useState=useState(props.orderList),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];return/*#__PURE__*/_jsx(Container,{className:\"orders-container\",children:/*#__PURE__*/_jsx(Row,{className:\"column\",children:/*#__PURE__*/_jsxs(Col,{className:\"column\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times-circle icon\",onClick:function onClick(){props.updateClickedState(props.type);history.push(\"/home\");}}),/*#__PURE__*/_jsxs(\"h3\",{className:\"title\",children:[props.type,\" Orders\"]}),/*#__PURE__*/_jsxs(Table,{striped:true,hover:true,size:\"sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"table-row table-header\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"table-header \",children:\"Asset\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-header\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-header\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-header\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order,index){if(order.type===props.type){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"table-body\",children:order.asset.name}),/*#__PURE__*/_jsx(\"td\",{className:\"table-body\",children:order.quantity}),/*#__PURE__*/_jsx(\"td\",{className:\"table-body\",children:order.price}),/*#__PURE__*/_jsx(\"td\",{className:\"table-body\",children:/*#__PURE__*/_jsx(Button,{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var updatedData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return deleteOffer(order.id);case 2:_context2.next=4;return props.fetchUserData();case 4:updatedData=_context2.sent;setOrders(updatedData.userData.organisationalUnit.offers);case 6:case\"end\":return _context2.stop();}}},_callee2);})),children:\"delete\"})})]},index);}})})]})]})})});};","map":{"version":3,"sources":["/Users/keeganfinegan/Documents/2021/SoftwareDevelopment/Assignment/supplyr/supplyr-frontend/src/components/Overview/Orders.js"],"names":["React","useState","Container","Row","Col","Table","Button","Cookies","jwt_decode","deleteOffer","orderId","url","token","get","fetch","method","headers","Authorization","accept","response","ok","decode","sub","newDataResponse","data","json","organisationalUnit","offers","console","log","Orders","props","orderList","orders","setOrders","updateClickedState","type","history","push","map","order","index","asset","name","quantity","price","id","fetchUserData","updatedData","userData"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport './Orders.css';\nimport { Container, Row, Col, Table, Button } from 'react-bootstrap';\nimport Cookies from 'js-cookie';\nimport jwt_decode from 'jwt-decode';\n\nconst deleteOffer = async (orderId) => {\n  const url = `http://localhost:8080/api/v1/offers/delete/`;\n\n  const token = Cookies.get('token');\n\n  try {\n    const response = await fetch(url + orderId, {\n      method: 'POST',\n      headers: {\n        Authorization: 'Bearer ' + token,\n        accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (response.ok) {\n      const decode = jwt_decode(token);\n      const newDataResponse = await fetch(\n        'http://localhost:8080/api/v1/users/' + decode.sub()\n      );\n      const data = newDataResponse.json();\n      return data.organisationalUnit.offers;\n\n      //return json\n    } else {\n      console.log(response.json());\n      //\n    }\n  } catch (error) {\n    //\n  }\n};\n\nexport const Orders = (props) => {\n  const [orders, setOrders] = useState(props.orderList);\n\n  return (\n    <Container className=\"orders-container\">\n      <Row className=\"column\">\n        <Col className=\"column\">\n          <i\n            className=\"fas fa-times-circle icon\"\n            onClick={() => {\n              props.updateClickedState(props.type);\n              history.push(\"/home\")\n            }}\n          ></i>\n          <h3 className=\"title\">{props.type} Orders</h3>\n\n          <Table striped hover size=\"sm\">\n            <thead>\n              <tr className=\"table-row table-header\">\n                <th className=\"table-header \">Asset</th>\n                <th className=\"table-header\">Quantity</th>\n                <th className=\"table-header\">Price</th>\n                <th className=\"table-header\">Action</th>\n              </tr>\n            </thead>\n            <tbody>\n              {orders.map((order, index) => {\n                if (order.type === props.type) {\n                  return (\n                    <tr key={index}>\n                      <td className=\"table-body\">{order.asset.name}</td>\n                      <td className=\"table-body\">{order.quantity}</td>\n                      <td className=\"table-body\">{order.price}</td>\n                      <td className=\"table-body\">\n                        <Button\n                          onClick={async () => {\n                            await deleteOffer(order.id);\n                            const updatedData = await props.fetchUserData();\n                            setOrders(\n                              updatedData.userData.organisationalUnit.offers\n                            );\n                          }}\n                        >\n                          delete\n                        </Button>\n                      </td>\n                    </tr>\n                  );\n                }\n              })}\n            </tbody>\n          </Table>\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}